<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Robot Traceur</title>
    

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script>
          var socket = io.connect('http://localhost:3013');
                 function startCanvas() {
        var startTime = (new Date()).getTime();
        animate(myRobot, canvas, ctx, startTime);
      };
    function Start(){
        socket.on('message', function(data) {
        insereMessage(data)
      });
        insereLog('connecté'); 
        startCanvas();
    }

    function insereLog(data) {
        var local = document.getElementById("statut");
        local.innerHTML=data;
      }
    function Stop(){
      if(socket){
             socket.disconnect(); 
           insereLog('deconnecté');
      };
       var myRobot = {
        x: 45,
        y: 45,
        width: 15,
        height: 15,
        borderWidth: 0.5
      }
      drawRobot();
      drawPath();
           
      }

      /*
       *Quand on reçoit un message, on l'insère dans la page
       */ 
      var id = 1;
      function insereMessage(data) {
        var table = document.getElementById("dataTable");
        var row  = table.insertRow(table.rows.length);
        var cell1 = row.insertCell(0); 
        cell1.innerHTML = id;
        id++;
        var cell2 = row.insertCell(1);
        cell2.innerHTML = "( "+data.PosRobotX+" ; "+data.PosRobotY+" )"; 
        var cell3 = row.insertCell(2);
        cell3.innerHTML = "( "+data.xi+" ; "+data.yi+" )"; 
      }
    </script>
  </head>
  <body>
    <nav>
  <!--<ul  >
      <li class="text-left" class="active"> <span><i class="icon-home"></i>Home</span></li>
      <li class="text-center">      <a href="team.html"><i class="icon-user"></i>Team</a></li>
      <li class="text-right">     <a href="project.html"><i class="icon-briefcase"></i>Project</a></li>
  </ul>-->

    </nav>
    <center>
        <h1 >Slam Robot</h1>   
        <p>

          <img src="./Slam_robot.png" height="200" width="200"alt="Slam Robot" class="img-circle"></p>
          <br/>
            <input type="button"  value="Stop"  class="btn btn-danger" onclick="Stop()"  /> 
            <input type="button" value="Start" class="btn btn-success" onclick="Start()" /> 
            <div id="statut">

            </div>
        </p>
          <br/>
        <canvas id="canvas" width="400%" height="300%">
	    <script src="canvas.js" type="text/javascript"></script> 
      </canvas>
      </center>
      <table id="dataTable" class="table table-striped">
        <tr>
          <th>Points</th>
          <th>Coordonnée du Robot (x;y)</th>
          <th>Coordonée de l'obstacle (x;y)</th>
        </tr>
      </table>
    </section>
  </body>
</html>
